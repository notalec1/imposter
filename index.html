<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>THE IMPOSTER: Cyberpunk</title>
    
    <!-- FONTS & LIBS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <!-- LOAD AI KEY -->
    <!-- Ensure ai_key.js exists in the same directory or remove this line if not using AI features -->
    <script src="ai_key.js"></script> 
    
    <!-- CSS LINK -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- BACKGROUND LAYERS -->
    <canvas id="matrixCanvas"></canvas>
    <div class="scanlines"></div>
    <div id="glitch-overlay-text">CONNECTION CORRUPT</div>

    <!-- BUTTONS -->
    <button id="theme-btn" onclick="cycleTheme()">ðŸŽ¨</button>
    <button id="ai-btn" onclick="toggleAIChat()">ðŸ¤–</button>

    <!-- AI CHAT OVERLAY -->
    <div id="ai-modal-overlay" onclick="toggleAIChat()">
        <div id="ai-chat-box" onclick="event.stopPropagation()">
            <div class="ai-header">
                <span>// TACTICAL.AI</span>
                <span class="ai-battery" id="ai-battery-display">BATTERY: |||</span>
                <span onclick="toggleAIChat()" style="cursor:pointer; color:red; margin-left:10px;">[X]</span>
            </div>
            <div id="ai-messages">
                <div class="msg ai">System Online. How may I assist your mission?</div>
            </div>
            <div class="ai-input-area">
                <input type="text" id="ai-input" placeholder="Type query..." autocomplete="off" onkeydown="if(event.key==='Enter') sendAIMessage()">
                <button id="ai-send" onclick="sendAIMessage()">></button>
            </div>
        </div>
    </div>

    <!-- MAIN APP -->
    <div id="app" class="container">
        <!-- Default Content -->
        <h1 id="loading-text" style="color:white; margin-top:30%;">INITIALIZING...</h1>
        <p>System Boot Sequence</p>
        <button class="btn btn-secondary" onclick="localStorage.clear(); location.reload()" style="margin-top:20px;">FORCE RESET</button>
    </div>

    <!-- QR MODAL -->
    <div id="qrModal" class="modal-overlay" onclick="closeModal()">
        <div class="qr-container" onclick="event.stopPropagation()">
            <h2 style="color:#000; text-shadow:none;">SCAN TARGET</h2>
            <div id="qrTarget"></div>
            <button class="btn btn-secondary" onclick="closeModal()" style="color:#000; border-color:#000; margin-top:20px;">DONE</button>
        </div>
    </div>

    <!-- JS LINK -->
    <script src="script.js"></script>
</body>
</html>
